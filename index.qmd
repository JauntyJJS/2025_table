---
format:
  html:
    embed-resources: true
    page-layout: full
execute: 
  warning: false
  message: false
  echo: false
  eval: true
---

```{r}
#| label: load pacakages
#| message: false

library(here)
library(readr)
library(tibble)
library(dplyr)
library(tidyr)
library(forcats)
library(lubridate)
library(purrr)
library(glue)
library(ggplot2)
library(gt)
library(fontawesome)

round_any = function(x, accuracy, f = round){f(x / accuracy) * accuracy}
```


```{r}
#| label: table title and subtitle

title <- "Visit Status of Singapore's Places of Interest"

subtitle <- '<p>Singapore has a mix of green spaces and cultural heritage for both Singaporeans and tourists alike.<br>In the table below, we explore the yearly (2010-2024) trends of the number of visits to some selected places of interest.<br><br><small>Links to the home page of each place of interest can be accessed by clicking on the <a <i class="bi bi-link-45deg" style="color:#000086; font-size: 20px;"></i></a> icon</small><p>'

```

```{r}
#| label: read data

visitors_full_data <- readr::read_csv(
  file = "https://raw.githubusercontent.com/JauntyJJS/2025_table/main/data/visitors.csv",
  show_col_types = FALSE
)

image_credits_data <- readr::read_csv(
  file = "https://raw.githubusercontent.com/JauntyJJS/2025_table/main/data/image_credits.csv",
  show_col_types = FALSE
)

places_introduction_data <- tibble::tribble(
  ~Places, ~Introduction,
  "Jurong Lake Gardens", "Located at the western region of Singapore, it comprises of three distinct garden areas: the Lakeside Garden, Chinese and Japanese Gardens. In 2019, rejuvenation works began on the Chinese and Japanese Gardens and was reopened in September 2024.",
  "Singapore Zoological Gardens", "A wildlife park that offers an open-concept enclosures, allowing animals to roam freely while visitors feel part of the ecosystem. It is home to over 4,200 animals where visitors can enjoy feeding experiences, animal shows and learn about wildlife protection efforts.",
  "Night Safari", "Unlike traditional zoos, the Night Safari opens at night, allowing guests to see nocturnal and crepuscular animals active in their natural environment. The park uses specialised moonlight-mimicking lighting to allow for unique, close-up viewing of animals without disturbing their natural behaviors.",
  "River Wonder", "Asia's first river-themed wildlife park, featuring one of the world's largest collections of river-dwelling animals. It focuses on freshwater conservation, offering immersive experiences such as themed river zones, a boat ride, and displays of threatened species like the Mekong giant catfish.",
  "Mandai Bird Paradise", "Opened on May 8, 2023, Mandai Bird Paradise is Asia's largest bird park. The 17-hectare park features eight large, themed walk-through aviaries that simulate different global biomes, allowing visitors to get close to more than 3,500 birds from over 400 species in immersive, naturalistic habitats.",
  "National Museum Of Singapore", "Housed in a Renaissance-style building, this museum is one of the nation's oldest museum, a cultural and architectural landmark that uses engaging exhibits to tell the story of Singapore's history and culture from its early beginnings to its development into a modern city-state.",
  "Asian Civilisations Museum", "This museum is home to many antiquities and decorative art, focusing on the heritage of Asia and the historical connections between different cultures. It explores material history of regions like China, Southeast Asia, and South Asia through a comprehensive collection and exhibitions.",
  "Peranakan Museum", "Home to over 800 artefacts, the museum delves into the vibrant culture of the Peranakan community, a diverse group of people in Southeast Asia with a mixed heritage. The museum reopened its doors on 2023 after nearly four years of renovation work.",
  "Indian Heritage Centre", "As Singapore's first museum dedicated to the Indian community, it traces their history and contributions in Singapore and Southeast Asia from the 1st century to the present day. Opened in May 2015, the 4-storey building features galleries with over 400 artefacts as well as a special eye-catching facade.",
  "Children's Museum Singapore", "A museum dedicated for children to cultivate a love for museums. Housed in a historic double-storey colonial building, it offers interactive, hands-on experiences where children learn, through play and exploration, about Singapore's culture and heritage.",
  "Science Centre Singapore", "An attraction that fosters interest in science and technology through hands-on exhibits and engaging shows. A new Science Centre is planned as part of the Jurong Lake District, designed to integrate nature with science through outdoor exhibits and landscaped gardens.",
  "Singapore Art Museum", "Singapore's first dedicated museum, presenting contemporary and visual arts from a Southeast Asian perspective. It closed its main heritage buildings in 2019 for redevelopment and was relocated to Tanjong Pagar DistriPark in January 2022"
)

places_homepage_data <- tibble::tribble(
  ~Places, ~Homepage,
  "Jurong Lake Gardens", '<a href="https://juronglakegardens.nparks.gov.sg/" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Singapore Zoological Gardens", '<a href="https://www.mandai.com/en/singapore-zoo.html/" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Night Safari", '<a href="https://www.mandai.com/en/night-safari.html/" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "River Wonder", '<a href="https://www.mandai.com/en/river-wonders.html" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Mandai Bird Paradise", '<a href="https://www.mandai.com/en/bird-paradise.html" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "National Museum Of Singapore", '<a href="https://www.nhb.gov.sg/nationalmuseum/" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Asian Civilisations Museum", '<a href="https://www.nhb.gov.sg/acm" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Peranakan Museum", '<a href="https://www.nhb.gov.sg/peranakanmuseum/" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Indian Heritage Centre", '<a href="https://www.indianheritage.gov.sg/en" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Children's Museum Singapore", '<a href="https://www.heritage.sg/childrensmuseum" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Science Centre Singapore", '<a href="https://www.science.edu.sg/" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>',
  "Singapore Art Museum", '<a href="https://www.singaporeartmuseum.sg/" target="_blank" <i class="bi bi-link-45deg" style="color:#000086; font-size: 18px;"></i></a>'  
)

```

```{r}
#| label: table text

# write caption for table
data_source <- '<a style="color:#000086" href="https://tablebuilder.singstat.gov.sg/table/TS/M891071" target="_blank">Visits To Selected Places Of Interest Data</a> from <a style="color:#000086" href="https://www.singstat.gov.sg/" target="_blank">Department of Statistics Singapore</a><br><br><p>Made by Jeremy Selva<a href="https://www.linkedin.com/in/jeremy-selva-085b9112a/" target="_blank"><svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#0077ac;overflow:visible;position:relative;"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><br><span class="citation" data-cites="JauntyJJS">@JauntyJJS</span><a style="text-decoration:none" href="https://github.com/JauntyJJS" target="_blank"><svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#000000;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a style="text-decoration:none" href="https://twitter.com/JauntyJJS" target="_blank"><svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#000000;overflow:visible;position:relative;"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm297.1 84L257.3 234.6 379.4 396H283.8L209 298.1 123.3 396H75.8l111-126.9L69.7 116h98l67.7 89.5L313.6 116h47.5zM323.3 367.6L153.4 142.9H125.1L296.9 367.6h26.3z"></path></svg></a><a style="text-decoration:none" href="https://bsky.app/profile/jauntyjjs.bsky.social" target="_blank"><svg aria-hidden="true" role="img" viewBox="0 0 576 512" style="height:1em;width:1.12em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1084ff;overflow:visible;position:relative;"><path d="M407.8 294.7c-3.3-.4-6.7-.8-10-1.3c3.4 .4 6.7 .9 10 1.3zM288 227.1C261.9 176.4 190.9 81.9 124.9 35.3C61.6-9.4 37.5-1.7 21.6 5.5C3.3 13.8 0 41.9 0 58.4S9.1 194 15 213.9c19.5 65.7 89.1 87.9 153.2 80.7c3.3-.5 6.6-.9 10-1.4c-3.3 .5-6.6 1-10 1.4C74.3 308.6-9.1 342.8 100.3 464.5C220.6 589.1 265.1 437.8 288 361.1c22.9 76.7 49.2 222.5 185.6 103.4c102.4-103.4 28.1-156-65.8-169.9c-3.3-.4-6.7-.8-10-1.3c3.4 .4 6.7 .9 10 1.3c64.1 7.1 133.6-15.1 153.2-80.7C566.9 194 576 75 576 58.4s-3.3-44.7-21.6-52.9c-15.8-7.1-40-14.9-103.2 29.8C385.1 81.9 314.1 176.4 288 227.1z"></path></svg></a><a style="text-decoration:none" href="https://fosstodon.org/@JauntyJJS" target="_blank"><svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#5f53e7;overflow:visible;position:relative;"><path d="M433 179.1c0-97.2-63.7-125.7-63.7-125.7-62.5-28.7-228.6-28.4-290.5 0 0 0-63.7 28.5-63.7 125.7 0 115.7-6.6 259.4 105.6 289.1 40.5 10.7 75.3 13 103.3 11.4 50.8-2.8 79.3-18.1 79.3-18.1l-1.7-36.9s-36.3 11.4-77.1 10.1c-40.4-1.4-83-4.4-89.6-54a102.5 102.5 0 0 1 -.9-13.9c85.6 20.9 158.7 9.1 178.8 6.7 56.1-6.7 105-41.3 111.2-72.9 9.8-49.8 9-121.5 9-121.5zm-75.1 125.2h-46.6v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.3V197c0-58.5-64-56.6-64-6.9v114.2H90.2c0-122.1-5.2-147.9 18.4-175 25.9-28.9 79.8-30.8 103.8 6.1l11.6 19.5 11.6-19.5c24.1-37.1 78.1-34.8 103.8-6.1 23.7 27.3 18.4 53 18.4 175z"></path></svg></a><br><a style="color:#000086" href="https://jeremy-selva.netlify.app/" target="_blank"><em>https://jeremy-selva.netlify.app</em> <svg aria-hidden="true" role="img" viewBox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#666666;overflow:visible;position:relative;"><path d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"></path></svg></a></p>'

```

```{r}
#| label: get images

# read in images from GitHub repo and set height

id <- image_credits_data$ID

all_images <- tibble::tibble(ID = image_credits_data$ID)

all_images <- all_images |> 
  dplyr::mutate(
    Image = glue::glue(
      "<img src='https://raw.githubusercontent.com/JauntyJJS/2025_table/main/images/{id}.jpg' style='height:130px;'>"
    )
  )

```

```{r}
#| label: prep data


visitors_data <- visitors_full_data |>
  tidyr::pivot_longer(
    cols = -c("ID", "Places"),
    names_to = c("Year Month"),
    values_to = "Visitors_In_Thousands"
  ) |>
  dplyr::mutate(
    `Year_Month` = lubridate::ym(.data[["Year Month"]])    
    
  ) |> 
  tidyr::separate(
    col = "Year Month",
    into = c("Year", "Month"),
    sep = " "
  ) |> 
  dplyr::mutate(
    Year = as.numeric(.data[["Year"]]),
    Month = forcats::fct_relevel(
      .data[["Month"]],
      c("Jan", "Feb", "Mar", "Apr", "May", "Jun",
        "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
    )
  )


```

```{r}
#| label: visitor data in years

visitors_data_years <- visitors_data |> 
  dplyr::mutate(
    Visitors_In_Thousands = dplyr::case_when(
      .data[["Visitors_In_Thousands"]] == "na" ~ "0",
      .default = .data[["Visitors_In_Thousands"]]
    )
  ) |> 
  dplyr::mutate(
    Visitors_In_Thousands = as.numeric(.data[["Visitors_In_Thousands"]])
  ) |>
  dplyr::reframe(
    Visitors_In_Thousands = sum(.data[["Visitors_In_Thousands"]]),
    .by = c("Places", "Year")
  ) |> 
  dplyr::mutate(
    is_zero = dplyr::if_else(
      .data[["Visitors_In_Thousands"]] == 0,
      "Yes",
      "No"
      ),
    is_zero_lead = dplyr::lead(.data[["is_zero"]]),
    is_zero_lag = dplyr::lag(.data[["is_zero"]]),
    is_zero_line = dplyr::case_when(
      .data[["is_zero"]] == "No" & dplyr::lead(.data[["is_zero"]]) == "No" ~ "No",
      dplyr::lag(.data[["is_zero"]]) == "Yes" ~ "Yes",
      .default = "No"
    )
  )

```

```{r}
#| label: jurong lake visitor

jurong_lake <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Jurong Lake Gardens" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: zoological garden visitor

zoological_garden <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Singapore Zoological Gardens" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: night safari visitor

night_safari <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Night Safari" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: river wonder visitor

river_wonder <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "River Wonders" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: mandai bird paradise visitor

mandai_bird_paradise <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Mandai Bird Paradise" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: national museum singapore visitor

national_museum_singapore <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "National Museum Of Singapore" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: asian civilisation museum visitor

asian_civilisations_museum <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Asian Civilisations Museum" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: peranakan museum visitor

peranakan_museum <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Peranakan Museum" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: indian heritage centre visitor

indian_heritage_centre <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Indian Heritage Centre" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: children museum singapore visitor

children_museum_singapore <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Children's Museum Singapore" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: science centre singapore visitor

science_centre_singapore <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Science Centre Singapore" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: singapore art museum visitor

singapore_art_museum <- visitors_data_years |> 
  dplyr::filter(
    .data[["Places"]] == "Singapore Art Museum" &
    .data[["Year"]] > 2009 &
    .data[["Year"]] < 2025
  ) |> 
  dplyr::mutate(
    Year = lubridate::ymd(.data[["Year"]], truncated = 2L)
  )

```

```{r}
#| label: jurong lake visitor plot

jurong_lake_plot <- jurong_lake |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01", "2023-01-01")),
    linetype = "solid", color = "purple", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(jurong_lake[["Visitors_In_Thousands"]]), 
    label = "Rejuvenation", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2023-01-01"), 
    y = max(jurong_lake[["Visitors_In_Thousands"]]), 
    label = "Reopened", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +   
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(jurong_lake[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: zoological garden visitor plot

zoological_garden_plot <- zoological_garden |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(zoological_garden[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.5
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(zoological_garden[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::coord_cartesian( clip = "off") +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: night safari visitor plot

night_safari_plot <- night_safari |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(night_safari[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.6
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(night_safari[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::coord_cartesian( clip = "off") +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: river wonder visitor plot

river_wonder_plot <- river_wonder |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2012-01-01")),
    linetype = "solid", color = "purple", size = 4, alpha = 0.4
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2012-01-01"), 
    y = max(river_wonder[["Visitors_In_Thousands"]]), 
    label = "Opening", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(river_wonder[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.6
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(river_wonder[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::coord_cartesian( clip = "off") +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: mandai bird paradise visitor plot

mandai_bird_paradise_plot <- mandai_bird_paradise |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2022-01-01")),
    linetype = "solid", color = "purple", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2022-01-01"), 
    y = max(mandai_bird_paradise[["Visitors_In_Thousands"]]), 
    label = "Opening", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(mandai_bird_paradise[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: national museum singapore visitor plot

national_museum_singapore_plot <- national_museum_singapore |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(national_museum_singapore[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.6
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(national_museum_singapore[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::coord_cartesian( clip = "off") +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: asian civilisations museum visitor plot

asian_civilisations_museum_plot <- asian_civilisations_museum |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(asian_civilisations_museum[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.8
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(asian_civilisations_museum[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: peranakan museum visitor plot

peranakan_museum_plot <- peranakan_museum |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01", "2022-01-01")),
    linetype = "solid", color = "purple", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(peranakan_museum[["Visitors_In_Thousands"]]), 
    label = "Renovation", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2022-01-01"), 
    y = max(peranakan_museum[["Visitors_In_Thousands"]]), 
    label = "Reopened", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +   
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(peranakan_museum[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: indian heritage centre plot

indian_heritage_centre_plot <- indian_heritage_centre |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2014-01-01")),
    linetype = "solid", color = "purple", size = 4, alpha = 0.4
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2014-01-01"), 
    y = max(indian_heritage_centre[["Visitors_In_Thousands"]]), 
    label = "Opening", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(indian_heritage_centre[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.6
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(indian_heritage_centre[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::coord_cartesian( clip = "off") +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: children museum singapore plot

children_museum_singapore_plot <- children_museum_singapore |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2022-01-01")),
    linetype = "solid", color = "purple", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2022-01-01"), 
    y = max(children_museum_singapore[["Visitors_In_Thousands"]]), 
    label = "Opening", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 1
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(children_museum_singapore[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: science centre singapore plot

science_centre_singapore_plot <- science_centre_singapore |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(asian_civilisations_museum[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.2
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(science_centre_singapore[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::coord_cartesian( clip = "off") +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```

```{r}
#| label: singapore art museum plot

singapore_art_museum_plot <- singapore_art_museum |> 
  ggplot2::ggplot(
    mapping = ggplot2::aes(
      x = .data[["Year"]],
      y = .data[["Visitors_In_Thousands"]]
    ),
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2019-01-01", "2022-01-01")),
    linetype = "solid", color = "purple", size = 4, alpha = 0.4
  ) +
  ggplot2::geom_vline(
    xintercept = as.Date(c("2020-01-01")),
    linetype = "solid", color = "red", size = 4, alpha = 0.4
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2019-01-01"), 
    y = max(singapore_art_museum[["Visitors_In_Thousands"]]), 
    label = "Renovation", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 0.8
  ) +    
  ggplot2::annotate(
    "text", 
    x = as.Date("2022-01-01"), 
    y = max(singapore_art_museum[["Visitors_In_Thousands"]]), 
    label = "Relocated", 
    angle = 90,
    size = 10,
    vjust = -0.7,
    hjust = 0.8
  ) +
  ggplot2::annotate(
    "text", 
    x = as.Date("2020-01-01"), 
    y = max(singapore_art_museum[["Visitors_In_Thousands"]]), 
    label = "Covid-19", 
    angle = 90,
    size = 10,
    vjust = -0.5,
    hjust = 0.8
  ) +
  ggplot2::geom_line(
    mapping = ggplot2::aes(
      color = .data[["is_zero_line"]],
      group = 1),
    linewidth = 3 
  ) +
  ggplot2::geom_point(
    mapping = ggplot2::aes(
      color = .data[["is_zero"]]),
    size = 10
  ) +
  ggplot2::labs(x = "", y = "Visit Numbers\n(Thousands)") +
  ggplot2::scale_color_manual(
    values = c("Black", "#74cdd3")
  ) +
  ggplot2::scale_x_date(
    breaks = as.Date(c("2010-01-01", "2015-01-01", "2020-01-01", "2024-01-01")),
    labels = c("2010", "2015", "2020", "2024")
    #date_breaks = "5 year",
    #date_labels = "%Y"
  ) + 
  ggplot2::scale_y_continuous(
    limits = c(
      0, 
      round_any(max(singapore_art_museum[["Visitors_In_Thousands"]]), 50, ceiling)
    )
  ) +
  ggplot2::coord_cartesian( clip = "off") +
  ggplot2::theme_minimal() +
  ggplot2::theme(
    legend.position = "none",
    panel.grid.minor = ggplot2::element_blank(),
    axis.title.y = ggplot2::element_text(
      margin = ggplot2::margin(r = 30),
      size = 30
    ),
    axis.text = element_text(size = 40),
    panel.grid.major.x = ggplot2::element_blank(),
    panel.grid.major.y = ggplot2::element_line(colour = "#8a8d8f", size = 1),
    plot.margin = ggplot2::margin(40, 40, 5, 5),
    plot.background = ggplot2::element_rect(fill = "transparent", colour = NA)
  )

```


```{r}
#| label: table setup

visitor_table <- image_credits_data |>
  dplyr::left_join(
    y = all_images,
    by = dplyr::join_by("ID")
  ) |> 
  dplyr::left_join(
    y = places_introduction_data,
    by = dplyr::join_by("Places")
  ) |>   
  dplyr::left_join(
    y = places_homepage_data,
    by = dplyr::join_by("Places")
  ) |>  
  dplyr::mutate(
    Places = glue::glue('<p><b>{.data[["Places"]]}</b> {.data[["Homepage"]]}<br><small>{.data[["Introduction"]]}</small><p>'),
    lines = NA
  ) |> 
  dplyr::select(
    c("Places", "Image", "lines")
  ) |> 
  dplyr::relocate(
    "Image"
  )

lineplot_list = list(
  jurong_lake_plot,
  zoological_garden_plot,
  night_safari_plot,
  river_wonder_plot,
  mandai_bird_paradise_plot,
  national_museum_singapore_plot,
  asian_civilisations_museum_plot,
  peranakan_museum_plot,
  indian_heritage_centre_plot,
  children_museum_singapore_plot,
  science_centre_singapore_plot,
  singapore_art_museum_plot
)

```

```{r}
#| label: make table

visitor_table |> 
  gt::gt() |> 
  gt::text_transform(
    locations = gt::cells_body(columns = Image),
    fn = function(x){
        purrr::map(
        visitor_table$Image, gt::html
      )
    }
  ) |> 
  gt::text_transform(
    locations = gt::cells_body(columns = Places),
    fn = function(x){
        purrr::map(
        visitor_table$Places, gt::html
      )
    }
  ) |> 
  # linecharts
  gt::text_transform(
    locations = cells_body(columns = lines),
    fn = function(x){
      purrr::map(
        lineplot_list, gt::ggplot_image, height = px(130), aspect_ratio = 3
      )
    }
  ) |>
  gt::tab_header(
    title = title,
    subtitle = gt::html(
      glue::glue("{subtitle}")
    )
  ) |> 
  # change column labels
  gt::cols_label(
    Image = "",
    Places = "",
    lines = gt::html(
      "Yearly visits number (in thousands) from 2010 to 2024.<br>Years with no visitors are coloured in <span style='color: #74cdd3; font-weight: bold;'>blue</span>."
    )
  ) |> 
  gt::cols_align(align = "left") |>
  gt::cols_width(
    Image ~ gt::pct(20),
    Places ~ gt::pct(40),
    lines ~ gt::pct(30)
  ) |>
  gt::tab_options(
    table.width = 1125,
    container.width = 1125,
    heading.padding = 20,
    column_labels.font.size = gt::pct(90),
  ) |>
  # source note using captions written previously
  gt::tab_source_note(
    source_note = gt::html(
      glue::glue("{data_source}")
    )
  ) |> 
  # title styling
  tab_style(
    locations = gt::cells_title(groups = "title"),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Chewy"),
      size = "xx-large",
      color = "#0E4732",
      align = "left")
    )
  ) |> 
  # subtitle styling
  gt::tab_style(
    locations = gt::cells_title(groups = "subtitle"),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Delius"),
      weight = "bold",
      size = "large", 
      color = "#167250",
      align = "left")
    )
  ) |>
  # column header styling
  gt::tab_style(
    locations = gt::cells_column_labels(),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Onest"),
      align = "left")
    )
  ) |>
  # notes styling
  gt::tab_style(
    locations = gt::cells_source_notes(),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Onest"),
      align = "left")
    )
  ) |>
  # Place Column styling
  gt::tab_style(
    locations = gt::cells_body(columns = c(Places)),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Onest")
      )
    )
  ) |> 
  gt::tab_style(
    style = cell_fill(color = "#f9f5e9"),
    locations = cells_body(rows = seq(1, 12, 2))
  )

```

```{r}
#| label: make image credits table

image_credits_table <- image_credits_data |> 
  dplyr::left_join(
    y = all_images,
    by = dplyr::join_by("ID")
  ) |> 
  dplyr::mutate(
    source_link = glue::glue(
      '<a style="color:#000086" href="{.data[["Image Link"]]}" target="_blank">{.data[["Description"]]}</a> by <a style="color:#000086" href="{.data[["Author Link"]]}" target="_blank">{.data[["Author"]]}</a> at <a style="color:#000086" href="{.data[["Website Link"]]}" target="_blank">{.data[["Website"]]}</a>'),
    cc_license = glue::glue(
      '<a style="color:#000086" href="{.data[["License Link"]]}" target="_blank">{.data[["License"]]}</a>')
  ) |> 
  dplyr::select(
    c("Image", "source_link", "cc_license")
  )

image_credits_table |> 
  gt::gt() |> 
  gt::text_transform(
    locations = gt::cells_body(columns = Image),
    fn = function(x){
        purrr::map(
        visitor_table$Image, gt::html
      )
    }
  ) |> 
  gt::text_transform(
    locations = gt::cells_body(columns = source_link),
    fn = function(x){
        purrr::map(
        image_credits_table$source_link, gt::html
      )
    }
  ) |> 
  gt::text_transform(
    locations = gt::cells_body(columns = cc_license),
    fn = function(x){
        purrr::map(
        image_credits_table$cc_license, gt::html
      )
    }
  ) |> 
  # column width
  gt::cols_width(
    Image ~ gt::pct(20),
    source_link ~ gt::pct(60),
    cc_license ~ gt::pct(20)
  ) |>
  gt::tab_options(
    table.width = 1125,
    container.width = 1125,
    heading.padding = 20,
    column_labels.font.size = gt::pct(90),
  ) |>
  # change column labels
  gt::cols_label(
    source_link = "Description",
    cc_license = "CC License"
  ) |> 
  gt::cols_align(align = "left") |> 
  gt::tab_header(
    title = "Image Credit",
    subtitle = "All images are cropped to an aspect ratio of 16:9."
  ) |> 
  # title styling
  tab_style(
    locations = gt::cells_title(groups = "title"),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Chewy"),
      size = "xx-large",
      color = "#0E4732",
      align = "left")
    )
  ) |> 
  # subtitle styling
  gt::tab_style(
    locations = gt::cells_title(groups = "subtitle"),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Delius"),
      weight = "bold",
      size = "large", 
      color = "#167250",
      align = "left")
    )
  ) |>
  # column header styling
  gt::tab_style(
    locations = gt::cells_column_labels(),
    style = list(
      gt::cell_text(font = gt::google_font(name = "Onest"),
      align = "left")
    )
  )
```


